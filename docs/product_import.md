# Product Import

## Overview 
AERCalc uses LBNL's WINDOW7 (W7) to list 'products' for import into AERCalc. For AERCalc's purposes, 
'products are windows in W7 with specific configurations and naming conventions.

When the AERCalc user imports one or more products (windows), W7 generates a `.bsdf` file each imported product,
 as well as an `.xml` representation with details on shading layer properties, glazing layer properties and so on. 

## Import Sequence

### Window List
The first part of the import sequence involves getting a complete list of available windows from W7. W7
generates an xml representation of it's windows table, including details about each windows components (glazing layer, shading layer, etc.)

Here is an example of one <Window/> record:

```$xslt
<?xml version="1.0" encoding="UTF-8"?>
<WindowRecords version="1.0">
    <Window>
        <GlzSysList>
            <GlassList>
                <Glass>
                </Glass>
            </GlassList>
            <GapList>
                <Gap>
                </Gap>
            </GapList>
            <ShadeList>
                <ShadingLayer>
                    <ShadeMaterial>
                    </ShadeMaterial>
                </ShadingLayer>
            </ShadeList>
        </GlzSysList>
        <FrameList>
            <Frame>
            </Frame>
        </FrameList>
        <DividerList>
            <Divider>
            </Divider>
        </DividerList>
    </Window>
</WindowRecords>
```

AERCalc parses this structure, pulling element values it needs to construct a view of each product for the user.

Here is an example of a complete <Window/> element:

```$xslt
<?xml version="1.0" encoding="UTF-8"?>
<WindowRecords version="1.0">
<Window>
	<ID>1003</ID>
	<ChromicsIndex>0</ChromicsIndex>
	<Certification></Certification>
	<Status>512</Status>
	<Timestamp>1508105493</Timestamp>
	<Name>Single cell Light color (Levolor) Interior::CS::BW-B</Name>
	<WintypeID>6</WintypeID>
	<Tilt>90.000000</Tilt>
	<PictureRef>0</PictureRef>
	<Scratch>5</Scratch>
	<SpacerDepth>0</SpacerDepth>
	<Sizeid>0</Sizeid>
	<Width>1200.000000</Width>
	<Height>1500.000000</Height>
	<ProjectedArea>1.800000</ProjectedArea>
	<NVisionAreas>1</NVisionAreas>
	<EnvConditions>1</EnvConditions>
	<EnvTimestamp>1130536170</EnvTimestamp>
	<Constraints>1</Constraints>
	<UvalWinter>1.581111</UvalWinter>
	<UvalSummer>1.541728</UvalSummer>
	<Tvis>0.173981</Tvis>
	<SHGC>0.261518</SHGC>
	<CI>-107374176.000000</CI>
	<InfiltrationRate>0</InfiltrationRate>
	<AnnualEnergyRating>0</AnnualEnergyRating>
	<Description></Description>
	<Manufacturer></Manufacturer>
	<SHGC0>0.002101</SHGC0>
	<SHGC1>0.837909</SHGC1>
	<GlzSysList>
		<ParentID>1003</ParentID>
		<Index>1</Index>
		<ChromicsIndex>0</ChromicsIndex>
		<GlzSysID>1003</GlzSysID>
		<GlzSysTimestamp>1507934352</GlzSysTimestamp>
		<Width>1085.699951</Width>
		<Height>1385.699951</Height>
		<Visionarea>0.000000</Visionarea>
		<GlassArea>1206715.625000</GlassArea>
		<EdgeArea>297738.781250</EdgeArea>
		<Uvalue>1.456595</Uvalue>
		<SHGC>0.310379</SHGC>
		<SC>0.356757</SC>
		<Tvis>0.208159</Tvis>
		<RHG>235.953522</RHG>
		<GlzSys>
			<ID>1003</ID>
			<ChromicsIndex>0</ChromicsIndex>
			<Name>Single cell Light color (Levolor) Interior::CS::BW-B</Name>
			<NLayers>3</NLayers>
			<EnvConditions>1</EnvConditions>
			<EnvTimestamp>1130536170</EnvTimestamp>
			<Tilt>90.000000</Tilt>
			<Keff>0.142637</Keff>
			<Thickness>76.935997</Thickness>
			<HoutWinter>29.200487</HoutWinter>
			<HoutSummer>20.646179</HoutSummer>
			<HinWinter>6.312842</HinWinter>
			<HinSummer>7.291790</HinSummer>
			<HCinWinter>2.330808</HCinWinter>
			<HRinWinter>3.982034</HRinWinter>
			<HCinSummer>2.751742</HCinSummer>
			<HRinSummer>4.540048</HRinSummer>
			<HCoutWinter>26.000000</HCoutWinter>
			<HRoutWinter>3.200487</HRoutWinter>
			<HCoutSummer>15.000000</HCoutSummer>
			<HRoutSummer>5.646179</HRoutSummer>
			<ToutWinter>-18.000000</ToutWinter>
			<ToutSummer>32.000000</ToutSummer>
			<TinWinter>21.000000</TinWinter>
			<TinSummer>24.000000</TinSummer>
			<SolarWinter>0.000000</SolarWinter>
			<SolarSummer>783.000000</SolarSummer>
			<UvalCenterWinter>1.446684</UvalCenterWinter>
			<UvalCenterSummer>1.395457</UvalCenterSummer>
			<SCWinter>0.000000</SCWinter>
			<SCSummer>0.356562</SCSummer>
			<SHGC>0.310209</SHGC>
			<RHInsideWinter>-91229998193783603000.000000</RHInsideWinter>
			<RHInsideSummer>-91229998193783603000.000000</RHInsideSummer>
			<RHOutsideWinter>-91229998193783603000.000000</RHOutsideWinter>
			<RHOutsideSummer>-91229998193783603000.000000</RHOutsideSummer>
			<RelHeatGain>235.811508</RelHeatGain>
			<Tsol>0.179143</Tsol>
			<Routsol>0.448768</Routsol>
			<Rinsol>0.651005</Rinsol>
			<Tvis>0.208159</Tvis>
			<Rinvis>0.645596</Rinvis>
			<Routvis>0.579536</Routvis>
			<Tuv>0.129656</Tuv>
			<Tir>0.000000</Tir>
			<Emishout>0.840000</Emishout>
			<Emishin>0.000000</Emishin>
			<Wldom1>0.498395</Wldom1>
			<Wldom2>0.494163</Wldom2>
			<Purity1>0.008044</Purity1>
			<Purity2>0.015996</Purity2>
			<Chrom1>0.000000</Chrom1>
			<Chrom2>0.000000</Chrom2>
			<Chrom3>0.000000</Chrom3>
			<Chrom4>0.000000</Chrom4>
			<Cielab1>52.757912</Cielab1>
			<Cielab2>-1.514129</Cielab2>
			<Cielab3>0.293899</Cielab3>
			<Cielab4>80.747932</Cielab4>
			<Cielab5>-3.567520</Cielab5>
			<Cielab6>0.331122</Cielab6>
			<Comment></Comment>
			<Color>0</Color>
			<Manufacturer></Manufacturer>
			<Certification>#</Certification>
			<Status>0</Status>
			<Timestamp>1507934352</Timestamp>
			<Tdw-K>0.148300</Tdw-K>
			<Tdw-ISO>0.184534</Tdw-ISO>
			<Height>1000.000000</Height>
			<Width>1000.000000</Width>
			<BSDFPath></BSDFPath>
			<ModelOptions>0</ModelOptions>
			<GlassList>
				<ParentID>1003</ParentID>
				<Index>1</Index>
				<ChromicsIndex>0</ChromicsIndex>
				<ID>102</ID>
				<Flip>0</Flip>
				<GlassTimestamp>1493430834</GlassTimestamp>
				<AbsSol>0.134829</AbsSol>
				<T1Uval>257.082184</T1Uval>
				<T2Uval>257.254150</T2Uval>
				<T1SHGC>313.750000</T1SHGC>
				<T2SHGC>314.130310</T2SHGC>
				<ShadeFlag>0</ShadeFlag>
				<Keff>1.000000</Keff>
				<Glass>
					<ID>102</ID>
					<Name>CLEAR_3.DAT</Name>
					<Source>IGDB v11.4</Source>
					<SpectralData>1</SpectralData>
					<AngularFunction>0</AngularFunction>
					<Thickness>3.048000</Thickness>
					<Tsol>0.833848</Tsol>
					<Rsol1>0.074764</Rsol1>
					<Rsol2>0.074854</Rsol2>
					<Tvis>0.899260</Tvis>
					<Rvis1>0.082563</Rvis1>
					<Rvis2>0.082564</Rvis2>
					<Tir>0.000000</Tir>
					<emis1>0.840000</emis1>
					<emis2>0.840000</emis2>
					<Conductivity>1.000000</Conductivity>
					<Comment></Comment>
					<Manufacturer>Generic</Manufacturer>
					<ProductName>Generic Clear Glass</ProductName>
					<Color>15856882</Color>
					<Certification>#</Certification>
					<Status>256</Status>
					<Timestamp>1493430834</Timestamp>
					<Specularity>0</Specularity>
					<Tvis2>0.899260</Tvis2>
					<Tsol2>0.833848</Tsol2>
					<MaterialID>0</MaterialID>
				</Glass>
			</GlassList>
			<GapList>
				<ParentID>1003</ParentID>
				<Index>1</Index>
				<ID>1</ID>
				<GasTimestamp>982726413</GasTimestamp>
				<Thickness>12.700000</Thickness>
				<Keff>0.062081</Keff>
				<Ventilated>0</Ventilated>
				<Vvent>0.000000</Vvent>
				<Tvent>0.000000</Tvent>
				<Keff_NoPillar>0.062081</Keff_NoPillar>
				<Gap>
					<ID>1</ID>
					<Name>Air</Name>
					<nGasses>0</nGasses>
					<ConductivityA>0.002873</ConductivityA>
					<ConductivityB>0.000078</ConductivityB>
					<ConductivityC>0.000000</ConductivityC>
					<ViscosityA>0.000004</ViscosityA>
					<ViscosityB>0.000000</ViscosityB>
					<ViscosityC>0.000000</ViscosityC>
					<MolecularWeight>28.969999</MolecularWeight>
					<CpA>1002.737000</CpA>
					<CpB>0.012324</CpB>
					<CpC>0.000000</CpC>
					<Color>0</Color>
					<Comment></Comment>
					<Certification></Certification>
					<Status>256</Status>
					<Timestamp>982726413</Timestamp>
					<Pressure>101325.000000</Pressure>
					<SpecificHeatRatio>1.400000</SpecificHeatRatio>
					<PillarID>0</PillarID>
					<Vacuum>0</Vacuum>
					<PillarTimestamp>0</PillarTimestamp>
				</Gap>
			</GapList>
			<GlassList>
				<ParentID>1003</ParentID>
				<Index>2</Index>
				<ChromicsIndex>0</ChromicsIndex>
				<ID>102</ID>
				<Flip>0</Flip>
				<GlassTimestamp>1493430834</GlassTimestamp>
				<AbsSol>0.124168</AbsSol>
				<T1Uval>268.796143</T1Uval>
				<T2Uval>268.968109</T2Uval>
				<T1SHGC>323.716156</T1SHGC>
				<T2SHGC>323.787384</T2SHGC>
				<ShadeFlag>0</ShadeFlag>
				<Keff>1.000000</Keff>
				<Glass>
					<ID>102</ID>
					<Name>CLEAR_3.DAT</Name>
					<Source>IGDB v11.4</Source>
					<SpectralData>1</SpectralData>
					<AngularFunction>0</AngularFunction>
					<Thickness>3.048000</Thickness>
					<Tsol>0.833848</Tsol>
					<Rsol1>0.074764</Rsol1>
					<Rsol2>0.074854</Rsol2>
					<Tvis>0.899260</Tvis>
					<Rvis1>0.082563</Rvis1>
					<Rvis2>0.082564</Rvis2>
					<Tir>0.000000</Tir>
					<emis1>0.840000</emis1>
					<emis2>0.840000</emis2>
					<Conductivity>1.000000</Conductivity>
					<Comment></Comment>
					<Manufacturer>Generic</Manufacturer>
					<ProductName>Generic Clear Glass</ProductName>
					<Color>15856882</Color>
					<Certification>#</Certification>
					<Status>256</Status>
					<Timestamp>1493430834</Timestamp>
					<Specularity>0</Specularity>
					<Tvis2>0.899260</Tvis2>
					<Tsol2>0.833848</Tsol2>
					<MaterialID>0</MaterialID>
				</Glass>
			</GlassList>
			<GapList>
				<ParentID>1003</ParentID>
				<Index>2</Index>
				<ID>1</ID>
				<GasTimestamp>982726413</GasTimestamp>
				<Thickness>38.099998</Thickness>
				<Keff>0.183022</Keff>
				<Ventilated>0</Ventilated>
				<Vvent>0.000000</Vvent>
				<Tvent>0.000000</Tvent>
				<Keff_NoPillar>0.183022</Keff_NoPillar>
				<Gap>
					<ID>1</ID>
					<Name>Air</Name>
					<nGasses>0</nGasses>
					<ConductivityA>0.002873</ConductivityA>
					<ConductivityB>0.000078</ConductivityB>
					<ConductivityC>0.000000</ConductivityC>
					<ViscosityA>0.000004</ViscosityA>
					<ViscosityB>0.000000</ViscosityB>
					<ViscosityC>0.000000</ViscosityC>
					<MolecularWeight>28.969999</MolecularWeight>
					<CpA>1002.737000</CpA>
					<CpB>0.012324</CpB>
					<CpC>0.000000</CpC>
					<Color>0</Color>
					<Comment></Comment>
					<Certification></Certification>
					<Status>256</Status>
					<Timestamp>982726413</Timestamp>
					<Pressure>101325.000000</Pressure>
					<SpecificHeatRatio>1.400000</SpecificHeatRatio>
					<PillarID>0</PillarID>
					<Vacuum>0</Vacuum>
					<PillarTimestamp>0</PillarTimestamp>
				</Gap>
			</GapList>
			<GlassList>
				<ParentID>1003</ParentID>
				<Index>3</Index>
				<ChromicsIndex>0</ChromicsIndex>
				<ID>1</ID>
				<Flip>0</Flip>
				<GlassTimestamp>0</GlassTimestamp>
				<AbsSol>0.113093</AbsSol>
				<T1Uval>279.200653</T1Uval>
				<T2Uval>287.514618</T2Uval>
				<T1SHGC>320.880249</T1SHGC>
				<T2SHGC>310.437469</T2SHGC>
				<ShadeFlag>1</ShadeFlag>
				<Keff>0.100967</Keff>
			</GlassList>
			<ShadeList>
				<ParentID>1003</ParentID>
				<Index>3</Index>
				<ID>1003</ID>
				<Flip>0</Flip>
				<ShadeTimestamp>1493441109</ShadeTimestamp>
				<At>0.000000</At>
				<Ab>0.000000</Ab>
				<Ar>3.000000</Ar>
				<Al>3.000000</Al>
				<ShadeMaterialTimestamp>0</ShadeMaterialTimestamp>
				<ShadeGapKeff>0.000000</ShadeGapKeff>
				<ShadeEmisRatio>0.246267</ShadeEmisRatio>
				<ShadeHcRatio>0.511097</ShadeHcRatio>
				<HcWithoutShade>2.330808</HcWithoutShade>
				<ShadingLayer>
					<ID>1003</ID>
					<Name>CS03</Name>
					<Type>7</Type>
					<ShadeMaterialID>30101</ShadeMaterialID>
					<PermeabilityFactor>0.000000</PermeabilityFactor>
					<Comment></Comment>
					<Status>0</Status>
					<Timestamp>1493441109</Timestamp>
					<BSDFPath>XML\CS03.thmx                                                                                                                                                                                                                                                  </BSDFPath>
					<ConvectionFactor>0.000000</ConvectionFactor>
					<ProductName></ProductName>
					<Manufacturer>foo</Manufacturer>
					<Source></Source>
					<Version>0</Version>
					<Certification></Certification>
					<ShadeMaterial>
						<ID>30101</ID>
						<Name>Slat Metal A</Name>
						<Source>CGDB</Source>
						<SpectralData>0</SpectralData>
						<AngularFunction>0</AngularFunction>
						<Thickness>0.600000</Thickness>
						<Tsol1_d>0.000000</Tsol1_d>
						<Tsol2_d>0.000000</Tsol2_d>
						<Rsol1_d>0.700000</Rsol1_d>
						<Rsol2_d>0.700000</Rsol2_d>
						<Tvis1_d>0.000000</Tvis1_d>
						<Tvis2_d>0.000000</Tvis2_d>
						<Rvis1_d>0.700000</Rvis1_d>
						<Rvis2_d>0.700000</Rvis2_d>
						<Tsol1_s>0.000000</Tsol1_s>
						<Tsol2_s>0.000000</Tsol2_s>
						<Rsol1_s>0.000000</Rsol1_s>
						<Rsol2_s>0.000000</Rsol2_s>
						<Tvis1_s>0.000000</Tvis1_s>
						<Tvis2_s>0.000000</Tvis2_s>
						<Rvis1_s>0.000000</Rvis1_s>
						<Rvis2_s>0.000000</Rvis2_s>
						<Tir>0.000000</Tir>
						<emis1>0.900000</emis1>
						<emis2>0.900000</emis2>
						<Conductivity>160.000000</Conductivity>
						<Comment>ISO 15099 Example Material</Comment>
						<Manufacturer>Generic</Manufacturer>
						<ProductName>Opaque white colored slat material</ProductName>
						<Color>16777215</Color>
						<Certification></Certification>
						<Status>256</Status>
						<Timestamp>1493424452</Timestamp>
						<Specularity>1</Specularity>
						<MaterialID>0</MaterialID>
						<Version>2.000000</Version>
					</ShadeMaterial>
				</ShadingLayer>
			</ShadeList>
		</GlzSys>
	</GlzSysList>
	<FrameList>
		<ParentID>1003</ParentID>
		<Index>1</Index>
		<FrameID>101</FrameID>
		<Width>65.000000</Width>
		<FrameTimestamp>1505157171</FrameTimestamp>
		<Area>65313.906250</Area>
		<EdgeArea>64909.695313</EdgeArea>
		<Uvalue>2.248404</Uvalue>
		<EdgeUvalue>1.419487</EdgeUvalue>
		<Frame>
			<ID>101</ID>
			<Name>BASE_B_HD_1003.thm</Name>
			<Source>2</Source>
			<Type>2</Type>
			<Uval>2.248404</Uval>
			<U_edge>1.419487</U_edge>
			<EdgeCorrelation>-1</EdgeCorrelation>
			<Pfd>57.150024</Pfd>
			<WettedLength>146.050018</WettedLength>
			<Ucenter>1.517545</Ucenter>
			<Igthick>18.700001</Igthick>
			<Abs>0.300000</Abs>
			<Info></Info>
			<Filename>..\AERC_sample_THERM_files\BASE_B_HD_1003.thm</Filename>
			<Comment></Comment>
			<TemperatureProfile>0</TemperatureProfile>
			<Color>9868875</Color>
			<Certification></Certification>
			<Status>0</Status>
			<Timestamp>1505157171</Timestamp>
		</Frame>
	</FrameList>
	<FrameList>
		<ParentID>1003</ParentID>
		<Index>2</Index>
		<FrameID>201</FrameID>
		<Width>65.000000</Width>
		<FrameTimestamp>1505158131</FrameTimestamp>
		<Area>82458.867188</Area>
		<EdgeArea>83959.695313</EdgeArea>
		<Uvalue>2.248863</Uvalue>
		<EdgeUvalue>1.419623</EdgeUvalue>
		<Frame>
			<ID>201</ID>
			<Name>BASE_B_JB_1003.thm</Name>
			<Source>2</Source>
			<Type>1</Type>
			<Uval>2.248863</Uval>
			<U_edge>1.419623</U_edge>
			<EdgeCorrelation>-1</EdgeCorrelation>
			<Pfd>57.149994</Pfd>
			<WettedLength>146.050003</WettedLength>
			<Ucenter>1.517545</Ucenter>
			<Igthick>18.700001</Igthick>
			<Abs>0.300000</Abs>
			<Info></Info>
			<Filename>..\AERC_sample_THERM_files\BASE_B_JB_1003.thm</Filename>
			<Comment></Comment>
			<TemperatureProfile>0</TemperatureProfile>
			<Color>9868875</Color>
			<Certification></Certification>
			<Status>0</Status>
			<Timestamp>1505158131</Timestamp>
		</Frame>
	</FrameList>
	<FrameList>
		<ParentID>1003</ParentID>
		<Index>3</Index>
		<FrameID>201</FrameID>
		<Width>65.000000</Width>
		<FrameTimestamp>1505158131</FrameTimestamp>
		<Area>82458.914063</Area>
		<EdgeArea>83959.695313</EdgeArea>
		<Uvalue>2.248863</Uvalue>
		<EdgeUvalue>1.419623</EdgeUvalue>
		<Frame>
			<ID>201</ID>
			<Name>BASE_B_JB_1003.thm</Name>
			<Source>2</Source>
			<Type>1</Type>
			<Uval>2.248863</Uval>
			<U_edge>1.419623</U_edge>
			<EdgeCorrelation>-1</EdgeCorrelation>
			<Pfd>57.149994</Pfd>
			<WettedLength>146.050003</WettedLength>
			<Ucenter>1.517545</Ucenter>
			<Igthick>18.700001</Igthick>
			<Abs>0.300000</Abs>
			<Info></Info>
			<Filename>..\AERC_sample_THERM_files\BASE_B_JB_1003.thm</Filename>
			<Comment></Comment>
			<TemperatureProfile>0</TemperatureProfile>
			<Color>9868875</Color>
			<Certification></Certification>
			<Status>0</Status>
			<Timestamp>1505158131</Timestamp>
		</Frame>
	</FrameList>
	<FrameList>
		<ParentID>1003</ParentID>
		<Index>4</Index>		<FrameID>301</FrameID>

		<Width>65.000000</Width>
		<FrameTimestamp>1505158158</FrameTimestamp>
		<Area>65313.906250</Area>
		<EdgeArea>64909.695313</EdgeArea>
		<Uvalue>2.256671</Uvalue>
		<EdgeUvalue>1.427539</EdgeUvalue>
		<Frame>
			<ID>301</ID>
			<Name>BASE_B_SL_1003.thm</Name>
			<Source>2</Source>
			<Type>0</Type>
			<Uval>2.256671</Uval>
			<U_edge>1.427539</U_edge>
			<EdgeCorrelation>-1</EdgeCorrelation>
			<Pfd>57.149994</Pfd>
			<WettedLength>146.050003</WettedLength>
			<Ucenter>1.517545</Ucenter>
			<Igthick>18.700001</Igthick>
			<Abs>0.300000</Abs>
			<Info></Info>
			<Filename>..\AERC_sample_THERM_files\BASE_B_SL_1003.thm</Filename>
			<Comment></Comment>
			<TemperatureProfile>0</TemperatureProfile>
			<Color>9868875</Color>
			<Certification></Certification>
			<Status>0</Status>
			<Timestamp>1505158158</Timestamp>
		</Frame>
	</FrameList>
</Window>
</WindowRecords>


```